!function(t){var o={defaults:{swapBox:"",loadBox:"",swapTriggerBox:".kool-swap",swapTrigger:"a",direction:"",inDuration:700,outDuration:500,inEasing:"easeInSine",outEasing:"easeInSine",bouncingBoxes:"",bouncingBoxHandling:"fade",preloadImages:!0,positionType:"fixed",moveSwapBoxClasses:"",history:!1,outerWidth:!1,loadErrorMessage:"The requested page was not found.",loadErrorBacklinkText:"Go back to the last page"},listenToPopState:function(o,s){t(window).off("popstate").on("popstate",function(t){var a;switch(o.direction){case"left-to-right":a="ks-swap-box-in-l-pushstate";break;case"right-to-left":a="ks-swap-box-in-r-pushstate";break;case"top-to-bottom":a="ks-swap-box-in-t-pushstate";break;case"bottom-to-top":a="ks-swap-box-in-b-pushstate";break;case"":a="ks-swap-box-in-pushstate";break;default:return alert("Kool Swap Error: \n The defined direction "+o.direction+" does not exist."),!1}e.swapHistoryPage(o,s,a),t.stopPropagation()})}},e={defaults:function(e,s){return psSettings=e.data("kool-swap-window"),"undefined"==typeof psSettings?(psSettings=t.extend({},o.defaults,s),e.data("kool-swap-window",psSettings)):psSettings=t.extend(psSettings,s),psSettings},init:function(s){var i=window.history&&history.pushState;return this.each(function(){e.defaults(t(this),s);var n=(t(psSettings.swapBox),psSettings.swapTriggerBox),r=psSettings.swapTrigger,l=!0;i&&t("html").not("[data-ks-initialised]")&&(t("html").attr("data-ks-initialised","true"),o.listenToPopState(psSettings,t(n+" "+r))),a.trigger(psSettings,i,n,r,l)})},swapHistoryPage:function(o,e,s){if(t("html").is("[data-ks-history-pushed]")){var i=location.pathname;e=e.filter('[href="'+i+'"]'),a.ksLoadPage(o,e,i,s)}},destroy:function(){return t(document).off("click",psSettings.swapTriggerBox+" "+psSettings.swapTrigger),t(this).each(function(){var o=t(this);o.removeData("kool-swap-window")})}},s={defaults:function(e,s){return settings=e.data("kool-swap"),"undefined"==typeof settings?(settings=t.extend({},o.defaults,s),e.data("kool-swap",settings)):settings=t.extend(settings,s),settings},init:function(e){var i=window.history&&history.pushState;return this.each(function(){s.defaults(t(this),e),settings.swapBox=t(this);var n,r=settings.swapTriggerBox,l=settings.swapTrigger;if(1==settings.history){var n=!0;i&&t("html").not("[data-ks-initialised]")&&(t("html").attr("data-ks-initialised","true"),o.listenToPopState(psSettings,t(r+" "+l)))}else var n=!1;a.trigger(settings,!0,r,l,n)})},destroy:function(){return t(document).off("click",settings.swapTriggerBox+" "+settings.swapTrigger),t(this).each(function(){var o=t(this);o.removeData("kool-swap")})}},a={trigger:function(o,e,s,i,n){function r(){var t=document.createElement("div");return t.setAttribute("ongesturestart","return;"),"function"==typeof t.ongesturestart}e&&(r()?t(document).on("touchstart",".ajaxPageSwitchBacklink",function(){window.history.back()}).off("touchstart",s+" "+i).on("touchstart",s+" "+i,function(s){s.preventDefault();var i=t(this);a.ksDefineSwapBoxIn(o,i,e,n)}):t(document).on("click",".ajaxPageSwitchBacklink",function(){window.history.back()}).off("click",s+" "+i).on("click",s+" "+i,function(s){s.preventDefault();var i=t(this);a.ksDefineSwapBoxIn(o,i,e,n)}))},ksDefineSwapBoxIn:function(o,e,s,i){switch(o.direction){case"left-to-right":case"right-to-left":case"top-to-bottom":case"bottom-to-top":case"":if($swapBoxIn="ks-swap-box-in",t(".ks-swap-box-in").length)return!1;{t(this)}a.ksCollectLoadPageInfo(o,e,s,$swapBoxIn,i);break;default:return alert("Kool Swap Error: \n The defined direction "+o.direction+" does not exist."),!1}},ksCollectLoadPageInfo:function(o,e,s,i,n){var i,r=e.attr("href");switch(o.direction){case"left-to-right":i="ks-swap-box-in-l";break;case"right-to-left":i="ks-swap-box-in-r";break;case"top-to-bottom":i="ks-swap-box-in-t";break;case"bottom-to-top":i="ks-swap-box-in-b";break;case"":i="ks-swap-box-in";break;default:return alert("Kool Swap Error: \n The defined direction "+o.direction+" does not exist."),!1}a.ksLoadPage(o,e,r,i,n),n&&(history.pushState({url:r},null,r),t("html").attr("data-ks-history-pushed","true"))},ksLoadPage:function(o,e,s,i,n){var r=t(o.swapBox);""!=s?(a.ksAddSwapBoxIn(o,i),t.ajax({type:"GET",url:s,data:{},beforeSend:function(){a.ksCreateLoadBox()},error:function(t,e,s){r.html(o.loadErrorMessage+"<p>"+e+": <strong>"+s+'</strong></p><p><a class="ajaxPageSwitchBacklink">'+o.loadErrorBacklinkText+"</a></p>")},success:function(s){t(o.swapTriggerBox).find("*").filter(".active").removeClass("active"),e.addClass("active"),o.bouncingBoxes?"fade"==o.bouncingBoxHandling?a.ksFadeSiblings(o,e,s,i,n):"slide"==o.bouncingBoxHandling&&a.ksSlideSiblings(o,e,s,r,i,n):a.ksPositionAndPrepare(o,e,s,i,n)},dataType:"html"})):alert("No target defined! Please check the references (i.e. normally href) of the swapTriggers.")},ksAddSwapBoxIn:function(o,e){var s=t(o.swapBox),a=s.attr("class"),i=s.prop("tagName");t(document).find(".ks-swap-box-in").remove(),s.after(o.moveSwapBoxClasses?"<"+i.toLowerCase()+' class="ks-swap-box-in '+("undefined"!=typeof a?a:"")+'" id="'+e+'"></'+i.toLowerCase()+">":"<"+i.toLowerCase()+' class="ks-swap-box-in" id="'+e+'"></'+i.toLowerCase()+">"),s.siblings(".ks-swap-box-in").hide()},ksFadeSiblings:function(o,e,s,i,n){t(document).find(o.bouncingBoxes).animate({opacity:0},50,function(){a.ksPositionAndPrepare(o,e,s,i,n)})},ksSlideSiblings:function(t,o,e,s,i){s.siblings("ks-ghost-box").remove(),s.wrap('<div class="ks-ghost-box" style="height: '+s.outerHeight(!0)+'px"></div>'),a.ksPositionAndPrepare(t,o,e,i)},ksPositionAndPrepare:function(o,e,s,i,n){var r=t(o.swapBox),l=r.attr("id"),c=r.position(),d=r.width(),p=r.css("margin-left"),u=r.css("margin-left"),f=c.left+parseFloat(p);if(swapBoxRightAbsolute=c.left+parseFloat(p)+d-parseFloat(u),$swapBoxIn=t("#"+i),loadSelector=e.attr("data-ks-load-selector"),o.outerWidth)var d=r.outerWidth();if(n)var g=s.match(/<\/*html\s+.*id="([^"].*)".*>/),h=s.match(/<\/*body\s+.*id="([^"].*)".*>/),k=s.match(/<\/*html\s+.*class="([^"].*)".*>/),w=s.match(/<\/*body\s+.*class="([^"].*)".*>/),b=s.match(/<\/*title>(.*)<\/title>/);if(r.addClass("ks-swap-box-out").css({position:"absolute",top:c.top,left:f,marginLeft:0,width:d}),swapBoxInContents=void 0!=t(s).filter("#"+l).html()){if(o.loadBox)var x=t(s).filter(o.loadBox);else if(loadSelector)var x=t(s).filter(loadSelector);else var x=t(s).filter("#"+l);swapBoxInContents=x.html();var m=x.attr("class")}else{if(o.loadBox)var x=t(s).find(o.loadBox);else if(loadSelector)var x=t(s).find(loadSelector);else var x=t(s).find("#"+l);swapBoxInContents=x.html();var m=x.attr("class")}$swapBoxIn.addClass(m).css({position:o.positionType,marginLeft:0,top:c.top,left:f}).html(swapBoxInContents);var S=$swapBoxIn.find("img"),v=0;S.length&&1==o.preloadImages?S.on("load",function(){v++,v==S.length&&(t(document).trigger("ksLoadCallback"),a.ksSwapContent(o,i,e,c,f,d,g,h,k,w,b,n))}):(t(document).trigger("ksLoadCallback"),a.ksSwapContent(o,i,e,c,f,d,g,h,k,w,b,n))},ksSwapContent:function(o,e,s,i,n,r,l,c,d,p,u,f){var g=t(o.swapBox),h=g.attr("id"),k=t("#"+e),w=k.outerHeight(),b=(k.outerWidth(),g.outerHeight()),x=t(window).outerHeight(),m=t(window).outerWidth(),S=s.prop("hash");if(clearTimeout(loadTimer),a.ksRemoveLoadBox(),o.direction){k.css({width:r});var v,B={},y={};switch(e){case"ks-swap-box-in-b-pushstate":case"ks-swap-box-in-t":k.css("top",2*-w),v=3*x;break;case"ks-swap-box-in-t-pushstate":case"ks-swap-box-in-b":k.css("top",1.5*b),v=1.5*-b;break;case"ks-swap-box-in-r-pushstate":case"ks-swap-box-in-l":k.css("left",-m),v=m;break;case"ks-swap-box-in-l-pushstate":case"ks-swap-box-in-r":k.css("left",m),v=-m;break;default:return alert("Kool Swap Error: \n The swapBoxIn class is in an undefined format: "+e+"."),!1}switch(o.direction){case"left-to-right":case"right-to-left":var C=o.inDuration,T=o.outDuration;B={left:v},y={left:n},k.css("top",i.top),t("body").css({overflowX:"hidden",overflowY:"scroll"});break;case"top-to-bottom":case"bottom-to-top":var P=b*o.inDuration/1e3,I=P/100,C=o.inDuration+I,T=o.outDuration;y={top:i.top},B={top:v},t("body").css("overflow-y","scroll")}var L=k.outerHeight(!0);g.parent(".ks-ghost-box")&&($ghostBox=g.parent(".ks-ghost-box"),$ghostBox.animate({height:L})),g.stop().show().animate(B,T,o.outEasing,function(){t(this).remove(),f&&(t(document).scrollTop(0),a.ksSwitchClasses(l,c,d,p,u))}),k.stop().show().animate(y,C,o.inEasing,function(){$ghostBox.remove(),t(this).css({display:"",left:"",marginLeft:"",position:"",top:"",width:""}).attr("id",h).removeClass("ks-swap-box-in"),a.animationCallback(S,o,f)})}else g.animate({opacity:0},o.outDuration,function(){t(this).remove(),f&&a.ksSwitchClasses(l,c,d,p,u),k.css({display:"",left:"",marginLeft:"",opacity:0,position:"",top:"",width:""}).animate({opacity:1},o.inDuration,function(){a.animationCallback(S,o,f)}).attr("id",h).removeClass("ks-swap-box-in")})},animationCallback:function(o,e,s){o&&t("html:not(:animated),body:not(:animated)").animate({scrollTop:t(o).offset().top},"normal"),a.ksCheckForSiblings(e,s)},ksCheckForSiblings:function(o,e){o.bouncingBoxes?t(document).find(o.bouncingBoxes).animate({opacity:1},400,function(){1==e?a.ksSwapCallback():a.ksSwapSectionCallback()}):e?a.ksSwapCallback():a.ksSwapSectionCallback()},ksSwitchClasses:function(o,e,s,a,i){t("html, body").attr({"class":"",id:""}),o?t("html").attr("id",o[1]):"",e?t("body").attr("id",e[1]):"",s?t("html").addClass(s[1]):"",a?t("body").addClass(a[1]):"",i?t("title").text(i[1]):""},ksCreateLoadBox:function(){t("#ks-loading-box").length?(a.ksRemoveLoadBox(),a.ksCreateLoadBox()):loadTimer=setTimeout(function(){t("html").append('<div id="ks-loading-box"><div class="ks-loading"></div></div>'),t("#ks-loading-box").fadeIn("fast")},200)},ksRemoveLoadBox:function(){t("#ks-loading-box").fadeOut("fast").remove()},ksSwapCallback:function(){t("body").css({overflowX:"auto"}),t(document).trigger("ksSwapCallback")},ksSwapSectionCallback:function(){t(document).trigger("ksSwapSectionCallback")}};t.koolSwap=function(o){return e[o]?e[o].apply(t(window),Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" does not exist on jQuery.KoolSwap"):e.init.apply(t(window),arguments,!1)},t.fn.koolSwap=function(o){return s[o]?s[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" does not exist on jQuery.KoolSwap"):s.init.apply(this,arguments)}}(jQuery);